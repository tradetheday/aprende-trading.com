---
import { getCollection } from 'astro:content';
import BaseHead from '../../components/BaseHead.astro';
import Footer from '../../components/Footer.astro';
import FormattedDate from '../../components/FormattedDate.astro';
import Header from '../../components/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../../consts';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="es">
	<head>
		<BaseHead title={`Articulos | ${SITE_TITLE}`} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<div class="page-header">
				<h1 class="section-title">Todos los Articulos</h1>
				<p class="page-description">Encuentra guias, estrategias y recursos para mejorar tu trading</p>
			</div>

			<div class="posts-list">
				{posts.map((post, index) => (
					<article class={`post-item ${index === 0 ? 'featured' : ''}`}>
						<a href={`/blog/${post.id}/`}>
							{index === 0 && <span class="featured-label">Mas Reciente</span>}
							<h2>{post.data.title}</h2>
							<div class="post-meta">
								<span class="post-date">
									<FormattedDate date={post.data.pubDate} />
								</span>
							</div>
							{post.data.description && (
								<p class="post-excerpt">{post.data.description}</p>
							)}
							<span class="read-more">Leer articulo &rarr;</span>
						</a>
					</article>
				))}
			</div>
		</main>
		<Footer />
	</body>
</html>

<style>
	.page-header {
		margin-bottom: 30px;
	}

	.section-title {
		font-size: 1rem;
		font-weight: 700;
		text-transform: uppercase;
		color: var(--white);
		background: var(--primary);
		padding: 8px 15px;
		margin-bottom: 15px;
		display: inline-block;
	}

	.page-description {
		color: var(--gray);
		font-size: 1rem;
		margin: 0;
	}

	.posts-list {
		display: flex;
		flex-direction: column;
	}

	.post-item {
		padding: 25px 0;
		border-bottom: 1px solid var(--gray-lighter);
	}

	.post-item:first-child {
		padding-top: 0;
	}

	.post-item a {
		display: block;
		text-decoration: none;
	}

	.post-item.featured {
		background: var(--gray-bg);
		padding: 25px;
		margin-bottom: 10px;
		border-bottom: none;
		border-left: 4px solid var(--primary);
	}

	.featured-label {
		display: inline-block;
		background: var(--primary);
		color: var(--white);
		font-size: 0.7rem;
		font-weight: 700;
		text-transform: uppercase;
		padding: 3px 8px;
		margin-bottom: 12px;
	}

	.post-item h2 {
		font-size: 1.25rem;
		color: var(--black);
		margin-bottom: 8px;
		line-height: 1.4;
		transition: color 0.2s ease;
	}

	.post-item.featured h2 {
		font-size: 1.5rem;
	}

	.post-item a:hover h2 {
		color: var(--primary);
	}

	.post-meta {
		margin-bottom: 8px;
	}

	.post-date {
		font-size: 0.85rem;
		color: var(--gray-light);
	}

	.post-excerpt {
		font-size: 0.95rem;
		color: var(--gray);
		margin-bottom: 12px;
		line-height: 1.6;
		display: -webkit-box;
		-webkit-line-clamp: 2;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}

	.read-more {
		display: inline-block;
		font-size: 0.9rem;
		font-weight: 600;
		color: var(--primary);
	}

	.post-item a:hover .read-more {
		text-decoration: underline;
	}

	@media (max-width: 768px) {
		.post-item.featured {
			padding: 20px;
		}

		.post-item h2 {
			font-size: 1.1rem;
		}

		.post-item.featured h2 {
			font-size: 1.25rem;
		}
	}
</style>
